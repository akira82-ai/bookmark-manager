<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºèƒ½æé†’æµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        button {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .primary-btn {
            background: #4299e1;
            color: white;
        }
        .primary-btn:hover {
            background: #3182ce;
        }
        .secondary-btn {
            background: #e2e8f0;
            color: #4a5568;
        }
        .secondary-btn:hover {
            background: #cbd5e0;
        }
        .danger-btn {
            background: #f56565;
            color: white;
        }
        .danger-btn:hover {
            background: #e53e3e;
        }
        .log-area {
            background: #1a202c;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        .status {
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-weight: 500;
        }
        .success {
            background: #c6f6d5;
            color: #22543d;
            border: 1px solid #9ae6b4;
        }
        .error {
            background: #fed7d7;
            color: #742a2a;
            border: 1px solid #fc8181;
        }
        .info {
            background: #bee3f8;
            color: #2a4365;
            border: 1px solid #90cdf4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§  æ™ºèƒ½æé†’æµ‹è¯•é¡µé¢</h1>
        
        <div id="status" class="status info">
            è¯·ç¡®ä¿å·²å®‰è£…ä¹¦ç­¾ç®¡ç†å™¨æ‰©å±•ï¼Œç„¶åç‚¹å‡»ä¸‹æ–¹æŒ‰é’®è¿›è¡Œæµ‹è¯•
        </div>
        
        <div class="button-group">
            <button class="primary-btn" onclick="testReminder()">ğŸ§ª æµ‹è¯•æé†’åŠŸèƒ½</button>
            <button class="secondary-btn" onclick="getDebugData()">ğŸ“Š è·å–è°ƒè¯•æ•°æ®</button>
            <button class="secondary-btn" onclick="clearData()">ğŸ—‘ï¸ æ¸…ç©ºæ•°æ®</button>
            <button class="danger-btn" onclick="simulateVisits()">ğŸ”„ æ¨¡æ‹Ÿè®¿é—®</button>
        </div>
        
        <div class="button-group">
            <button class="secondary-btn" onclick="visitXDomain()">ğŸŒ è®¿é—® x.com</button>
            <button class="secondary-btn" onclick="addTestBookmark()">ğŸ“Œ æ·»åŠ æµ‹è¯•ä¹¦ç­¾</button>
        </div>
        
        <h3>ğŸ“ è°ƒè¯•æ—¥å¿—</h3>
        <div id="log" class="log-area"></div>
    </div>

    <script>
        let logCount = 0;
        
        function log(message, type = 'info') {
            const logArea = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#fc8181' : type === 'success' ? '#68d391' : '#90cdf4';
            logArea.innerHTML += `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
            logArea.scrollTop = logArea.scrollHeight;
        }
        
        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }
        
        async function testReminder() {
            log('å‘é€æµ‹è¯•æé†’è¯·æ±‚...');
            try {
                const response = await chrome.runtime.sendMessage({ action: 'testReminder' });
                log('æµ‹è¯•æé†’è¯·æ±‚å·²å‘é€', 'success');
                updateStatus('æµ‹è¯•æé†’å·²è§¦å‘ï¼Œè¯·æŸ¥çœ‹å³ä¸Šè§’æ˜¯å¦å‡ºç°å¼¹çª—', 'success');
            } catch (error) {
                log(`æµ‹è¯•æé†’å¤±è´¥: ${error.message}`, 'error');
                updateStatus('æµ‹è¯•å¤±è´¥ï¼Œè¯·ç¡®ä¿æ‰©å±•å·²æ­£ç¡®å®‰è£…', 'error');
            }
        }
        
        async function getDebugData() {
            log('è·å–è°ƒè¯•æ•°æ®...');
            try {
                const response = await chrome.runtime.sendMessage({ action: 'debugData' });
                log('è°ƒè¯•æ•°æ®:', 'info');
                log(`åŸŸåæ•°æ®: ${JSON.stringify(response.domainData, null, 2)}`, 'info');
                log(`URLæ•°æ®: ${JSON.stringify(response.urlData, null, 2)}`, 'info');
                log(`è®¾ç½®: ${JSON.stringify(response.settings, null, 2)}`, 'info');
                updateStatus('è°ƒè¯•æ•°æ®å·²è·å–ï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—', 'success');
            } catch (error) {
                log(`è·å–è°ƒè¯•æ•°æ®å¤±è´¥: ${error.message}`, 'error');
                updateStatus('è·å–è°ƒè¯•æ•°æ®å¤±è´¥', 'error');
            }
        }
        
        async function clearData() {
            log('æ¸…ç©ºæé†’æ•°æ®...');
            try {
                await chrome.storage.local.remove(['reminderData']);
                log('æé†’æ•°æ®å·²æ¸…ç©º', 'success');
                updateStatus('æé†’æ•°æ®å·²æ¸…ç©ºï¼Œéœ€è¦é‡æ–°åŠ è½½æ‰©å±•', 'success');
            } catch (error) {
                log(`æ¸…ç©ºæ•°æ®å¤±è´¥: ${error.message}`, 'error');
                updateStatus('æ¸…ç©ºæ•°æ®å¤±è´¥', 'error');
            }
        }
        
        async function simulateVisits() {
            log('æ¨¡æ‹Ÿè®¿é—®x.com...');
            try {
                // æ¨¡æ‹Ÿå¤šæ¬¡è®¿é—®
                for (let i = 0; i < 3; i++) {
                    await chrome.runtime.sendMessage({
                        action: 'quickAddBookmark',
                        data: {
                            title: `X.com Page ${i}`,
                            url: `https://x.com/page${i}`
                        }
                    });
                    log(`æ¨¡æ‹Ÿè®¿é—® x.com/page${i}`, 'info');
                }
                log('æ¨¡æ‹Ÿè®¿é—®å®Œæˆï¼Œç­‰å¾…30ç§’åæ£€æŸ¥æé†’æ¡ä»¶', 'success');
                updateStatus('æ¨¡æ‹Ÿè®¿é—®å®Œæˆï¼Œæé†’å°†åœ¨30ç§’å†…è§¦å‘', 'success');
            } catch (error) {
                log(`æ¨¡æ‹Ÿè®¿é—®å¤±è´¥: ${error.message}`, 'error');
                updateStatus('æ¨¡æ‹Ÿè®¿é—®å¤±è´¥', 'error');
            }
        }
        
        async function visitXDomain() {
            log('æ‰“å¼€ x.com...');
            try {
                await chrome.tabs.create({ url: 'https://x.com' });
                log('å·²æ‰“å¼€ x.com æ ‡ç­¾é¡µ', 'success');
                updateStatus('å·²æ‰“å¼€ x.comï¼Œè¯·åœ¨è¯¥é¡µé¢ä¸Šå¤šæ¬¡åˆ·æ–°ä»¥è§¦å‘æé†’', 'success');
            } catch (error) {
                log(`æ‰“å¼€ x.com å¤±è´¥: ${error.message}`, 'error');
                updateStatus('æ‰“å¼€ x.com å¤±è´¥', 'error');
            }
        }
        
        async function addTestBookmark() {
            log('æ·»åŠ æµ‹è¯•ä¹¦ç­¾åˆ°æœ€è¿‘æ”¶è—...');
            try {
                const response = await chrome.runtime.sendMessage({
                    action: 'addBookmarkFromReminder',
                    data: {
                        title: 'æµ‹è¯•ä¹¦ç­¾ - ' + new Date().toLocaleTimeString(),
                        url: 'https://example.com/test'
                    }
                });
                log('æµ‹è¯•ä¹¦ç­¾å·²æ·»åŠ ', 'success');
                updateStatus('æµ‹è¯•ä¹¦ç­¾å·²æ·»åŠ åˆ°æœ€è¿‘æ”¶è—', 'success');
            } catch (error) {
                log(`æ·»åŠ æµ‹è¯•ä¹¦ç­¾å¤±è´¥: ${error.message}`, 'error');
                updateStatus('æ·»åŠ æµ‹è¯•ä¹¦ç­¾å¤±è´¥', 'error');
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶çš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            log('æµ‹è¯•é¡µé¢å·²åŠ è½½', 'success');
            updateStatus('æµ‹è¯•é¡µé¢å·²å‡†å¤‡å°±ç»ª', 'success');
        });
    </script>
</body>
</html>