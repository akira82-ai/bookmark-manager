<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>深色模式文字颜色测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        
        .test-container {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ccc;
        }
        
        /* 测试1：没有指定文字颜色的元素 */
        .no-color {
            background: white;
            padding: 10px;
            margin: 10px 0;
        }
        
        /* 测试2：明确指定深色文字 */
        .dark-text {
            background: white;
            color: #333;
            padding: 10px;
            margin: 10px 0;
        }
        
        /* 测试3：使用内联样式但没有颜色 */
        .inline-no-color {
            background: white;
            padding: 10px;
            margin: 10px 0;
        }
        
        /* 测试4：使用内联样式且有颜色 */
        .inline-with-color {
            background: white;
            color: #333;
            padding: 10px;
            margin: 10px 0;
        }
        
        .info {
            background: #e7f3ff;
            border: 1px solid #b6d7ff;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .current-theme {
            font-weight: bold;
            color: #007bff;
        }
    </style>
</head>
<body>
    <h1>🔍 深色模式文字颜色问题分析</h1>
    
    <div class="info">
        <p>当前浏览器主题：<span class="current-theme" id="current-theme">检测中...</span></p>
        <p>当前系统颜色方案：<span class="current-theme" id="color-scheme">检测中...</span></p>
    </div>
    
    <div class="test-container">
        <h3>测试1：CSS类，未指定文字颜色</h3>
        <div class="no-color">
            这段文字没有指定颜色，在深色模式下可能会变成浅色
        </div>
    </div>
    
    <div class="test-container">
        <h3>测试2：CSS类，明确指定深色文字</h3>
        <div class="dark-text">
            这段文字明确指定了 color: #333，应该始终可见
        </div>
    </div>
    
    <div class="test-container">
        <h3>测试3：内联样式，未指定文字颜色（模拟当前弹窗）</h3>
        <div class="inline-no-color" style="background: white; border: 1px solid #ccc; padding: 15px; width: 250px;">
            <div style="font-weight: bold; margin-bottom: 10px;">💡 智能提醒</div>
            <div style="margin-bottom: 15px; font-size: 14px;">您近期已访问多次当前网站，需要收藏吗？</div>
        </div>
    </div>
    
    <div class="test-container">
        <h3>测试4：内联样式，指定文字颜色</h3>
        <div class="inline-with-color" style="background: white; border: 1px solid #ccc; padding: 15px; width: 250px;">
            <div style="font-weight: bold; margin-bottom: 10px; color: #333;">💡 智能提醒</div>
            <div style="margin-bottom: 15px; font-size: 14px; color: #333;">您近期已访问多次当前网站，需要收藏吗？</div>
        </div>
    </div>
    
    <button onclick="createTestToast()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; margin: 10px 0;">
        创建测试弹窗
    </button>
    
    <div id="toast-container"></div>
    
    <script>
        // 检测当前主题
        function updateThemeInfo() {
            const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)').matches;
            const currentTheme = prefersDarkScheme ? '深色模式' : '浅色模式';
            const colorScheme = prefersDarkScheme ? 'dark' : 'light';
            
            document.getElementById('current-theme').textContent = currentTheme;
            document.getElementById('color-scheme').textContent = colorScheme;
        }
        
        // 创建测试弹窗（模拟content.js中的弹窗）
        function createTestToast() {
            const container = document.getElementById('toast-container');
            
            // 清除之前的弹窗
            const existingToast = document.getElementById('test-toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            // 创建弹窗（完全复制content.js的逻辑）
            const toast = document.createElement('div');
            toast.id = 'test-toast';
            toast.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 999999;
                background: white;
                border: 1px solid #ccc;
                border-radius: 5px;
                padding: 15px;
                width: 250px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                font-family: Arial, sans-serif;
            `;
            
            toast.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 10px;">💡 智能提醒</div>
                <div style="margin-bottom: 15px; font-size: 14px;">您近期已访问多次当前网站，需要收藏吗？</div>
                <div style="display: flex; gap: 5px;">
                    <button style="padding: 5px 10px; border: none; background: #007bff; color: white; border-radius: 3px; cursor: pointer;">收藏</button>
                    <button onclick="this.parentElement.parentElement.remove()" style="padding: 5px 10px; border: 1px solid #ccc; background: white; border-radius: 3px; cursor: pointer; margin-left: auto;">关闭</button>
                </div>
            `;
            
            container.appendChild(toast);
            
            // 10秒后自动关闭
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 10000);
        }
        
        // 页面加载时更新主题信息
        updateThemeInfo();
        
        // 监听系统主题变化
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', updateThemeInfo);
    </script>
</body>
</html>